{% import 'image.html' as image %}
{% extends "layout.html" %}
{% block body %}

<div class="action-bar">

  <details class="sort-dropdown">
    <summary class="sort-button">
      {% if order in ['old', 'zyx', 'authza', 'pubold'] %}&#x25BC;{% else %}&#x25B2;{% endif %}
      {% if order == "new" %}{{_('Recently Added')}}
      {% elif order == "old" %}{{_('Added First')}}
      {% elif order in ["abc", "zyx"] %}{{_('Alphabetical')}}
      {% elif order in ["authaz", "authza"] %}{{_('Author Name')}}
      {% elif order in ["pubnew", "pubold"] %}{{_('Publish Date')}}
      {% else %}{{_('Sort Books')}}
      {% endif %}
    </summary>
    <ul class="sort-menu">

      {# 1. DYNAMIC TOP SLOT: The reverse of the current sort #}
      {% if order == 'new' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='old')}}">&#x25BC; {{_('Added First')}}</a></li>
      {% elif order == 'old' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='new')}}">&#x25B2; {{_('Recently Added')}}</a></li>
      {% elif order == 'abc' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='zyx')}}">&#x25BC; {{_('Alphabetical')}}</a></li>
      {% elif order == 'zyx' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='abc')}}">&#x25B2; {{_('Alphabetical')}}</a></li>
      {% elif order == 'authaz' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='authza')}}">&#x25BC; {{_('Author Name')}}</a></li>
      {% elif order == 'authza' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='authaz')}}">&#x25B2; {{_('Author Name')}}</a></li>
      {% elif order == 'pubnew' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='pubold')}}">&#x25BC; {{_('Publish Date')}}</a></li>
      {% elif order == 'pubold' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='pubnew')}}">&#x25B2; {{_('Publish Date')}}</a></li>
      {% endif %}

      <li class="sort-divider" role="separator"></li>

      {# 2. THE REST: All other sort options except the active pair #}
      {% if order != 'new' and order != 'old' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='new')}}">&#x25B2; {{_('Recently Added')}}</a></li>
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='old')}}">&#x25BC; {{_('Added First')}}</a></li>
      {% endif %}

      {% if order != 'abc' and order != 'zyx' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='abc')}}">&#x25B2; {{_('Alphabetical')}}</a></li>
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='zyx')}}">&#x25BC; {{_('Alphabetical')}}</a></li>
      {% endif %}

      {% if order != 'authaz' and order != 'authza' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='authaz')}}">&#x25B2; {{_('Author Name')}}</a></li>
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='authza')}}">&#x25BC; {{_('Author Name')}}</a></li>
      {% endif %}

      {% if order != 'pubnew' and order != 'pubold' %}
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='pubnew')}}">&#x25B2; {{_('Publish Date')}}</a></li>
        <li><a href="{{url_for('web.books_list', data=page, book_id=id, sort_param='pubold')}}">&#x25BC; {{_('Publish Date')}}</a></li>
      {% endif %}

    </ul>
  </details>

  <form class="search-form" role="search" action="{{url_for('search.simple_search')}}" method="GET">
    <input type="text" class="search-input" name="query" placeholder="{{_('Search Library')}}" value="{{searchterm}}">
    <button type="submit" class="search-submit">{{_('Search')}}</button>
  </form>

</div>

<div class="books-grid">
  {% if entries[0] %}
    {% for entry in entries %}
    <div class="book-cover">
      {{ image.book_cover(entry.Books) }}
    </div>
    {% endfor %}
  {% endif %}
</div>

{% endblock %}
